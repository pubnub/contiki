<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Pubnub Contiki Library: Pubnub client library for Contiki OS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Pubnub Contiki Library
   </div>
   <div id="projectbrief">PubnublibraryforContikiOS</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Pubnub client library for Contiki OS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Pubnub library for Contiki OS is designed for embedded/constrained devices. It consists of just two files - the header, which has the interface of the library, and the implementation (.c) file. Header is fully documented in Doxygen compatible comments.</p>
<p>There are no special requirements of the library, and it should be usable as-is on any platform that Contiki is ported to.</p>
<p>It has only the basic operations: publish, subscribe and "leave", and is designed with minimal amount of code in mind. It's data memory requirements can be tweaked by the user, but are by design static and brought down to minimum.</p>
<h2>File Organization</h2>
<p>The files of the library repository are:</p>
<ul>
<li><code><a class="el" href="pubnub_8h.html">pubnub.h</a></code> : the interface of the library, #include this in your code, and search the comments for documentation. You can also generate Doxygen documentation from it.</li>
<li><code>pubnub.c</code> : the implementation of the library, compile &amp;link this with your code</li>
<li><code>pubnubDemo.c</code> : A simple demo of how the library should be used. Build this (with pubnub.c and Contiki) for a basic example of how stuff works.</li>
<li><code>pubnub.t.c</code> : The unit test. It uses the cgreen unit testing library and has "total" line coverage (only the lines that <em>can't</em> be executed - sanity checks - are not covered). You can look at it to see various ways to interact with the library, but as most test code, it's not very user-friendly. You can also build and run it yourself, if you wish.</li>
<li><code>Makefile</code> : basic Makefile to build the pubnubDemo "app" and pubnub.t unit test. Use are is, or look for clues on how to make one for yourself.</li>
<li><code>LICENSE</code> and this <code>README.md</code> should be self-explanatory.</li>
</ul>
<h2>Design considerations</h2>
<p>The fundamental flow for working with the library is this:</p>
<p>0. Foremost, you should have a Contiki OS process to handle the outcome of your requests. You can work without them, but that would be somewhat clumsy. Of course, this can be done in an already existing Contiki OS process of yours.</p>
<ol type="1">
<li>Obtain a Pubnub "context" from the library. It is an opaque pointer. <em>Note</em>: you can't create contexts on your own. "All Pubnub contexz
   are belong to us." :)</li>
<li>Initialize the context, giving the subscribe and publish key.</li>
<li>Start a operation/transaction/Pubnub API call on the context. It will either fail or return an indication of "started". The outcome will be sent to your process, with event indicating the transaction type and data being the context on which the transaction was carried out.</li>
<li>On receipt of the process event, check the context for the result (success or indication of failure). If OK and it was a subscribe transaction, you can get the messages that were fetched (and, if available, the channels they pertain too).</li>
<li>When you're done processing the outcome event, you can start a new transaction in that context.</li>
</ol>
<p>This is ilustrated in pubnubDemo.c, similar to this: </p>
<pre class="fragment">static pubnub_t *m_pb = pubnub_get_ctx(0);
pubnub_init(m_pb, pubkey, subkey);

etimer_set(&amp;et, 3*CLOCK_SECOND);

while (1) {
    PROCESS_WAIT_EVENT();
    if (ev == PROCESS_EVENT_TIMER) {
        pubnub_publish(m_pb, channel, "\"ConTiki Pubnub voyager\"");
    }
    else if (ev == pubnub_publish_event) {
        pubnub_subscribe(m_pb, channel);
    }
    else if (ev == pubnub_subscribe_event) {
        for (;;) {
            char const *msg = pubnub_get(m_pb);
            if (NULL == msg) {
                break;
            }
            printf("Received message: %s\n", msg);
        }
        etimer_restart(&amp;et);
    }
}
</pre><h3>Remarks</h3>
<ul>
<li>We said there are no requirements, because we assume the minimal Contiki OS. But, in fact, <em>we do</em> expect that:<ul>
<li>you have both UDP and TCP enabled</li>
<li>you have IPv4 enabled</li>
<li>you have DNS enabled</li>
</ul>
</li>
<li>While you may have parallel transactions running in different contexts, a single context can handle only one transaction at a time.</li>
<li>You have to start the <code>pubnub_process</code> at some point, preferrably before you initiate any transaction. It does not start automatically. This enables you to start it at your own convinience. The pubnubDemo starts it in the <code>AUTOSTART_PROCESSES</code> list, but you don't have to do it like that. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Feb 4 2015 22:53:28 for Pubnub Contiki Library by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
